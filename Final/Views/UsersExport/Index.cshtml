@model IEnumerable<Final.Models.User>

@{
    ViewBag.Title = "Index";
}

<h2>Index</h2>

    <a id="btnExport" style="cursor: pointer;">Экспорт</a>

<table class="table" id="thisTable">
    <tr>
        <th>
            @Html.DisplayNameFor(model => model.Login)
        </th>
        <th class="noExl">
            @Html.DisplayNameFor(model => model.PassHash)
        </th>
        <th>
            @Html.DisplayNameFor(model => model.FName)
        </th>
        <th>
            @Html.DisplayNameFor(model => model.MName)
        </th>
        <th>
            @Html.DisplayNameFor(model => model.LName)
        </th>
    </tr>

@foreach (var item in Model) {
    <tr>
        <td>
            @Html.DisplayFor(modelItem => item.Login)
        </td>
        <td class="noExl">
            @Html.DisplayFor(modelItem => item.PassHash)
        </td>
        <td>
            @Html.DisplayFor(modelItem => item.FName)
        </td>
        <td>
            @Html.DisplayFor(modelItem => item.MName)
        </td>
        <td>
            @Html.DisplayFor(modelItem => item.LName)
        </td>
    </tr>
}

</table>

@section Scripts {
    @Scripts.Render("~/Scripts/jquery.table2excel.min.js")
    <script type="text/javascript">
        $("#btnExport").click(function () {
            $("#thisTable").table2excel({
                // исключить данные помеченные классом noExl
                exclude: ".noExl",
                name: "Worksheet",
                filename: "Список пользователей", //do not include extension
                fileext: ".xls" // file extension
            });
        });
    </script>
    }
